<!DOCTYPE html>
<html>

<head lang="ru">
    <meta charset="UTF-8">
    <title>basic-model</title>
    <script type="text/javascript" src="components/ddp.js/src/ddp.js"></script>
    <script type="text/javascript" src="components/q/q.js"></script>
    <script type="text/javascript" src="components/asteroid/dist/asteroid.browser.js"></script>
    <script type="text/javascript" src="rationale.js"></script>
    <!--
    <script type="text/javascript" src="components/webcomponentsjs/webcomponents.js"></script>
    <link rel="import" href="components/polymer/polymer.html">
    -->

    <style>
    body {
        font-family: sans-serif;
        margin: 0;
        overflow: hidden;
    }
    </style>
</head>

<body>
<script>
/* Наша основная функция, которая начнёт работать после соединения с бэкендом */
function player (result) {
//console.log("PLAYER", result);
/*
 * НАЧАЛО НАШЕГО КОДА
 */
    var pl = players.reactiveQuery({name: "pl1"});
    console.log(pl.result[0]);
    pl.on("change", function(objId) {
            console.log("pl changed, objId:", objId, "pl result:", pl.result[0]);
    }
    );
/*
 * КОНЕЦ НАШЕГО КОДА
 */
    return result.result
};

// Перечисляем имена коллекций, на которые подписываемся
// В функции колбэка (в данном примере, player),
// автоматически создадутся глобальные объекты с этими именами, содержащие коллекции,
// например, в данном случае, window.players и window.designs
//  
var collections = ["players", "designs"] 
// Соединяемся с бекендом Rationale и подписываемся на коллекции
raConnect("localhost:3000", collections, player);
</script>
</body>
</html>
